"""
    **ÃœrÃ¼n Envanter Sistemi**: Dictionary ile Ã¼rÃ¼n ekleme, stok gÃ¼ncelleme, arama
"""

products = []
categories = {}

def add_category():
    input_category = input("Kategori adÄ±: ").strip()
    if not input_category:
        print("âœ–ï¸ Kategori adÄ± boÅŸ olamaz!")
        return

    input_category = input_category.title()
    if input_category in categories.values():
        print("âœ–ï¸ Bu kategori zaten mevcut!")
        return

    new_id = len(categories) + 1
    categories[new_id] = input_category
    print(f"âœ”ï¸ '{input_category}' kategorisi eklendi (ID: {new_id}).")


def add_product():
    if not categories:
        print("âœ–ï¸ Ã–nce en az bir kategori ekleyin!")
        return

    print("\nMevcut kategoriler:")
    for cid, name in categories.items():
        print(f"  {cid}: {name}")
    
    try:
        cat_id = int(input("\nKategori ID'sini seÃ§in: "))
        if cat_id not in categories:
            print("âœ–ï¸ GeÃ§ersiz kategori ID'si!")
            return
    except ValueError:
        print("âœ–ï¸ LÃ¼tfen geÃ§erli bir sayÄ± girin!")
        return

    product_name = input("ÃœrÃ¼n adÄ±: ").strip()
    if not product_name:
        print("âœ–ï¸ ÃœrÃ¼n adÄ± boÅŸ olamaz!")
        return
    product_name = product_name.title()

    for product in products:
        if product["category_id"] == cat_id and product["product_name"] == product_name:
            print("âœ–ï¸ Bu kategoride aynÄ± isimde bir Ã¼rÃ¼n zaten var!")
            return

    try:
        stock = int(input("Stok miktarÄ±: "))
        if stock < 0:
            print("âœ–ï¸ Stok negatif olamaz!")
            return
    except ValueError:
        print("âœ–ï¸ Stok sayÄ±sÄ± geÃ§ersiz!")
        return

    new_product = {
        "id": len(products),
        "category_id": cat_id,
        "product_name": product_name,
        "stock": stock
    }
    products.append(new_product)
    print(f"âœ… '{product_name}' Ã¼rÃ¼nÃ¼ eklendi (Kategori: {categories[cat_id]}).")


def update_stock():
    if not products:
        print("âœ–ï¸ HenÃ¼z Ã¼rÃ¼n eklenmemiÅŸ!")
        return

    search_term = input("Stok gÃ¼ncellemek iÃ§in Ã¼rÃ¼n adÄ± veya ID girin: ").strip()
    if not search_term:
        print("âœ–ï¸ Arama terimi boÅŸ olamaz!")
        return

    matched_products = []
    if search_term.isdigit():
        product_id = int(search_term)
        for p in products:
            if p["id"] == product_id:
                matched_products.append(p)
                break

    if not matched_products:
        search_term = search_term.title()
        for p in products:
            if search_term in p["product_name"]:
                matched_products.append(p)

    if not matched_products:
        print("âœ–ï¸ ÃœrÃ¼n bulunamadÄ±!")
        return
    elif len(matched_products) == 1:
        product = matched_products[0]
    else:
        print("\nBirden fazla Ã¼rÃ¼n bulundu:")
        for i, p in enumerate(matched_products):
            print(f"  {i+1}. ID: {p['id']}, ÃœrÃ¼n: {p['product_name']}, Stok: {p['stock']}")
        try:
            choice = int(input("GÃ¼ncellemek iÃ§in seÃ§im yapÄ±n (1-{}): ".format(len(matched_products))))
            if 1 <= choice <= len(matched_products):
                product = matched_products[choice - 1]
            else:
                print("âœ–ï¸ GeÃ§ersiz seÃ§im!")
                return
        except ValueError:
            print("âœ–ï¸ GeÃ§ersiz seÃ§im!")
            return

    try:
        new_stock = int(input(f"Mevcut stok: {product['stock']}\nYeni stok miktarÄ±: "))
        if new_stock < 0:
            print("âœ–ï¸ Stok negatif olamaz!")
            return
        product["stock"] = new_stock
        print(f"âœ… '{product['product_name']}' stok miktarÄ± {new_stock} olarak gÃ¼ncellendi.")
    except ValueError:
        print("âœ–ï¸ GeÃ§ersiz stok deÄŸeri!")


def search():
    """ÃœrÃ¼n ara (isim veya kategoriye gÃ¶re)."""
    if not products:
        print("âœ–ï¸ ÃœrÃ¼n listesi boÅŸ!")
        return

    term = input("Arama terimi (Ã¼rÃ¼n adÄ± veya kategori): ").strip()
    if not term:
        print("âœ–ï¸ Arama terimi boÅŸ olamaz!")
        return

    term = term.title()
    results = []

    for p in products:
        cat_name = categories.get(p["category_id"], "Bilinmeyen")
        if term in p["product_name"] or term == cat_name:
            results.append(p)

    if not results:
        print("âœ–ï¸ AradÄ±ÄŸÄ±nÄ±z kriterde Ã¼rÃ¼n bulunamadÄ±.")
    else:
        print(f"\nâœ”ï¸ {len(results)} Ã¼rÃ¼n bulundu:")
        print("-" * 60)
        print(f"{'ID':<5} {'Kategori':<15} {'ÃœrÃ¼n AdÄ±':<20} {'Stok':<10}")
        print("-" * 60)
        for p in results:
            cat_name = categories.get(p["category_id"], "Bilinmeyen")
            print(f"{p['id']:<5} {cat_name:<15} {p['product_name']:<20} {p['stock']:<10}")



while True:
    print("\n" + "="*50)
    print("ÃœRÃœN ENVANTER SÄ°STEMÄ°")
    print("="*50)
    print("1. Kategori Ekle")
    print("2. ÃœrÃ¼n Ekle")
    print("3. Stok GÃ¼ncelle")
    print("4. ÃœrÃ¼n Ara")
    print("5. TÃ¼m ÃœrÃ¼nleri GÃ¶ster")
    print("q. Ã‡Ä±kÄ±ÅŸ")
    print("-"*50)
    
    option = input("SeÃ§iminiz: ").strip().lower()

    if option == "1":
        add_category()
    elif option == "2":
        add_product()
    elif option == "3":
        update_stock()
    elif option == "4":
        search()
    elif option == "5":
        if not products:
            print("âœ–ï¸ ÃœrÃ¼n listesi boÅŸ.")
        else:
            print("\nğŸ“‹ TÃœM ÃœRÃœNLER:")
            print("-" * 60)
            print(f"{'ID':<5} {'Kategori':<15} {'ÃœrÃ¼n AdÄ±':<20} {'Stok':<10}")
            print("-" * 60)
            for p in products:
                cat_name = categories.get(p["category_id"], "Bilinmeyen")
                print(f"{p['id']:<5} {cat_name:<15} {p['product_name']:<20} {p['stock']:<10}")
    elif option == "q":
        print("âœ”ï¸ Programdan Ã§Ä±kÄ±lÄ±yor. Ä°yi gÃ¼nler!")
        break
    else:
        print("âœ–ï¸ GeÃ§ersiz seÃ§im! LÃ¼tfen 1-5 arasÄ±nda bir deÄŸer girin veya 'q' ile Ã§Ä±kÄ±n.")
